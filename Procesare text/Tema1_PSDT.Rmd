---
title: "T1_PSDT_11.01.2025"
author: "Irimia Mihaela"
date: "2025-01-11"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Exploratory Data Analysis of a Dataset Consisting of Seven Poems using various R libraries

### Analysis of a Dataset Consisting of Seven Poems Using NLP Tools

[***Objective:***]{style="color:blue;"} In this study, we will implement methods such as Natural Language Processing (NLP) to perform text analytics and visualization. Most of the time, the data is available in an unstructured format, and to derive insights from it, preprocessing is required. We will use NLP algorithms to read the text and extract meaningful information. Specifically, this study analyzes seven poems and generates graphical visualizations, including word distributions, word clouds, and more, using various R libraries.

In the working session, we will upload the package we need:

```{r poems1, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
library(dplyr)
library(tidytext)
library(janeaustenr)
library(stringr)
library(forcats)
library(ggplot2)
library(scales)
library(tidyr)
library(tm) # text analysis - text mining
library(wordcloud) # create wordcloud
library(syuzhet)
library(haven)
library(readr)
```

## Database creation

We will create our database by adding, one by one, seven poems written in English by different authors. The poems are available on the [Poetryfoundation](https://www.poetryfoundation.org/poems/) platform. The resulting database will be analyzed.

The full text poem is available [here](https://lithub.com/the-32-most-iconic-poems-in-the-english-language/ "Still I Rise by Maya Angelou") (***Still I Rise By Maya Angelou***)

```{r poems2, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# url = <https://www.poetryfoundation.org/poems/46446/still-i-rise>
poem_text1 <- c("You may write me down in history",
           "With your bitter, twisted lies,",
           "You may trod me in the very dirt",
           "But still, like dust, I'll rise.",
           "Does my sassiness upset you?",
           "Why are you beset with gloom?",
           "’Cause I walk like I've got oil wells",
           "Pumping in my living room.",
           "Just like moons and like suns,",
           "With the certainty of tides,",
           "Just like hopes springing high,",
           "Still I'll rise.",
           "Did you want to see me broken?",
           "Bowed head and lowered eyes?",
           "Shoulders falling down like teardrops,",
           "Weakened by my soulful cries?",
           "Does my haughtiness offend you?",
           "Don't you take it awful hard",
           "’Cause I laugh like I've got gold mines",
           "Diggin’ in my own backyard.",
           "You may shoot me with your words,",
           "You may cut me with your eyes,",
           "You may kill me with your hatefulness,",
           "But still, like air, I’ll rise.",
           "Does my sexiness upset you?",
           "Does it come as a surprise",
           "That I dance like I've got diamonds",
           "At the meeting of my thighs?",
           "Out of the huts of history’s shame",
           "I rise",
           "Up from a past that’s rooted in pain",
           "I rise",
           "I'm a black ocean, leaping and wide,",
           "Welling and swelling I bear in the tide.",
           "Leaving behind nights of terror and fear",
           "I rise",
           "Into a daybreak that’s wondrously clear",
           "I rise",
           "Bringing the gifts that my ancestors gave,",
           "I am the dream and the hope of the slave.",
           "I rise",
           "I rise",
           "I rise.")
```

The first few lines of the data are presented:

```{r poems3, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text1)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/43991/kubla-khan "Kubla Khan By Samuel Taylor Coleridge") (***Kubla Khan By Samuel Taylor Coleridge***)

```{r poems4, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# url = <https://www.poetryfoundation.org/poems/43991/kubla-khan>
poem_text2 <- c("In Xanadu did Kubla Khan",
           "A stately pleasure-dome decree:",
           "Where Alph, the sacred river, ran",
           "Through caverns measureless to man",
           "Down to a sunless sea.",
           "So twice five miles of fertile ground",
           "With walls and towers were girdled round;",
           "And there were gardens bright with sinuous rills,",
           "Where blossomed many an incense-bearing tree;",
           "And here were forests ancient as the hills,",
           "Enfolding sunny spots of greenery.",
           "But oh! that deep romantic chasm which slanted",
           "Down the green hill athwart a cedarn cover!",
           "A savage place! as holy and enchanted",
           "As e’er beneath a waning moon was haunted",
           "By woman wailing for her demon-lover!",
           "And from this chasm, with ceaseless turmoil seething,",
           "As if this earth in fast thick pants were breathing,",
           "A mighty fountain momently was forced:",
           "Amid whose swift half-intermitted burst",
           "Huge fragments vaulted like rebounding hail,",
           "Or chaffy grain beneath the thresher’s flail:",
           "And mid these dancing rocks at once and ever",
           "It flung up momently the sacred river.",
           "Five miles meandering with a mazy motion",
           "Through wood and dale the sacred river ran,",
           "Then reached the caverns measureless to man,",
           "And sank in tumult to a lifeless ocean;",
           "And ’mid this tumult Kubla heard from far",
           "Ancestral voices prophesying war!",
           "The shadow of the dome of pleasure",
           "Floated midway on the waves;",
           "Where was heard the mingled measure",
           "From the fountain and the caves.",
           "It was a miracle of rare device,",
           "A sunny pleasure-dome with caves of ice!",
           "A damsel with a dulcimer",
           "In a vision once I saw:",
           "It was an Abyssinian maid",
           "And on her dulcimer she played,",
           "Singing of Mount Abora.",
           "Could I revive within me",
           "Her symphony and song,",
           "To such a deep delight ’twould win me,",
           "That with music loud and long,",
           "I would build that dome in air,",
           "That sunny dome! those caves of ice!",
           "And all who heard should see them there,",
           "And all should cry, Beware! Beware!",
           "His flashing eyes, his floating hair!",
           "Weave a circle round him thrice,",
           "And close your eyes with holy dread",
           "For he on honey-dew hath fed,",
           "And drunk the milk of Paradise.")
```

The first few lines of the data are presented:

```{r poems5, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text2)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/45477/song-of-myself-1892-version "Song of Myself (1892 version) By Walt Whitman") (***Song of Myself (1892 version) By Walt Whitman***)

```{r poems6, echo = FALSE}
poem_text3 <- c(
  "Turning and turning in the widening gyre",
  "The falcon cannot hear the falconer;",
  "Things fall apart; the centre cannot hold;",
  "Mere anarchy is loosed upon the world,",
  "The blood-dimmed tide is loosed, and everywhere",
  "The ceremony of innocence is drowned;",
  "The best lack all conviction, while the worst",
  "Are full of passionate intensity.",
  
  "Surely some revelation is at hand;",
  "Surely the Second Coming is at hand.",
  "The Second Coming! Hardly are those words out",
  "When a vast image out of Spiritus Mundi",
  "Troubles my sight: somewhere in sands of the desert",
  "A shape with lion body and the head of a man,",
  "A gaze blank and pitiless as the sun,",
  "Is moving its slow thighs, while all about it",
  "Reel shadows of the indignant desert birds.",
  
  "The darkness drops again; but now I know",
  "That twenty centuries of stony sleep",
  "Were vexed to nightmare by a rocking cradle,",
  "And what rough beast, its hour come round at last,",
  "Slouches towards Bethlehem to be born?"
)

```

The first few lines of the data are presented:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text3)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/47652/because-i-could-not-stop-for-death-479 "Because I could not stop for Death – (479) By Emily Dickinson") (***Because I could not stop for Death -- (479) By Emily Dickinson***)

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}

poem_text4 <- c(
  "Because I could not stop for Death –",
  "He kindly stopped for me –",
  "The Carriage held but just Ourselves –",
  "And Immortality.",
  
  "We slowly drove – He knew no haste",
  "And I had put away",
  "My labor and my leisure too,",
  "For His Civility –",
  
  "We passed the School, where Children strove",
  "At Recess – in the Ring –",
  "We passed the Fields of Gazing Grain –",
  "We passed the Setting Sun –",
  
  "Or rather – He passed Us –",
  "The Dews drew quivering and Chill –",
  "For only Gossamer, my Gown –",
  "My Tippet – only Tulle –",
  
  "We paused before a House that seemed",
  "A Swelling of the Ground –",
  "The Roof was scarcely visible –",
  "The Cornice – in the Ground –",
  
  "Since then – 'tis Centuries – and yet",
  "Feels shorter than the Day",
  "I first surmised the Horses' Heads",
  "Were toward Eternity –"
)
```

The first few lines of the data are presented:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text4)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/44479/ode-to-a-nightingale "Ode to a Nightingale by John Keats") (***Ode to a Nightingale by John Keats***)

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# url = https://www.poetryfoundation.org/poems/44479/ode-to-a-nightingale
poem_text5 <- c(
  "My heart aches, and a drowsy numbness pains",
  "My sense, as though of hemlock I had drunk,",
  "Or emptied some dull opiate to the drains",
  "One minute past, and Lethe-wards had sunk:",
  "'Tis not through envy of thy happy lot,",
  "But being too happy in thine happiness, —",
  "That thou, light-winged Dryad of the trees",
  "In some melodious plot",
  "Of beechen green, and shadows numberless,",
  "Singest of summer in full-throated ease.",
  
  "O, for a draught of vintage! that hath been",
  "Cool’d a long age in the deep-delved earth,",
  "Tasting of Flora and the country green,",
  "Dance, and Provençal song, and sunburnt mirth!",
  "O for a beaker full of the warm South,",
  "Full of the true, the blushful Hippocrene,",
  "With beaded bubbles winking at the brim,",
  "And purple-stained mouth;",
  "That I might drink, and leave the world unseen,",
  "And with thee fade away into the forest dim:",
  
  "Fade far away, dissolve, and quite forget",
  "What thou among the leaves hast never known,",
  "The weariness, the fever, and the fret",
  "Here, where men sit and hear each other groan;",
  "Where palsy shakes a few, sad, last gray hairs,",
  "Where youth grows pale, and spectre-thin, and dies;",
  "Where but to think is to be full of sorrow",
  "And leaden-eyed despairs,",
  "Where Beauty cannot keep her lustrous eyes,",
  "Or new Love pine at them beyond to-morrow.",
  
  "Away! away! for I will fly to thee,",
  "Not charioted by Bacchus and his pards,",
  "But on the viewless wings of Poesy,",
  "Though the dull brain perplexes and retards:",
  "Already with thee! tender is the night,",
  "And haply the Queen-Moon is on her throne,",
  "Cluster’d around by all her starry Fays;",
  "But here there is no light,",
  "Save what from heaven is with the breezes blown",
  "Through verdurous glooms and winding mossy ways.",
  
  "I cannot see what flowers are at my feet,",
  "Nor what soft incense hangs upon the boughs,",
  "But, in embalmed darkness, guess each sweet",
  "Wherewith the seasonable month endows",
  "The grass, the thicket, and the fruit-tree wild;",
  "White hawthorn, and the pastoral eglantine;",
  "Fast fading violets cover’d up in leaves;",
  "And mid-May’s eldest child,",
  "The coming musk-rose, full of dewy wine,",
  "The murmurous haunt of flies on summer eves.",
  
  "Darkling I listen; and, for many a time",
  "I have been half in love with easeful Death,",
  "Call’d him soft names in many a mused rhyme,",
  "To take into the air my quiet breath;",
  "Now more than ever seems it rich to die,",
  "To cease upon the midnight with no pain,",
  "While thou art pouring forth thy soul abroad",
  "In such an ecstasy!",
  "Still wouldst thou sing, and I have ears in vain—",
  "To thy high requiem become a sod.",
  
  "Thou wast not born for death, immortal Bird!",
  "No hungry generations tread thee down;",
  "The voice I hear this passing night was heard",
  "In ancient days by emperor and clown:",
  "Perhaps the self-same song that found a path",
  "Through the sad heart of Ruth, when, sick for home,",
  "She stood in tears amid the alien corn;",
  "The same that oft-times hath",
  "Charm’d magic casements, opening on the foam",
  "Of perilous seas, in faery lands forlorn.",
  
  "Forlorn! the very word is like a bell",
  "To toll me back from thee to my sole self!",
  "Adieu! the fancy cannot cheat so well",
  "As she is fam’d to do, deceiving elf.",
  "Adieu! adieu! thy plaintive anthem fades",
  "Past the near meadows, over the still stream,",
  "Up the hill-side; and now ’tis buried deep",
  "In the next valley-glades:",
  "Was it a vision, or a waking dream?",
  "Fled is that music:—Do I wake or sleep?"
) 

```

The first few lines of the data are presented:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text5)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/43997/the-rime-of-the-ancient-mariner-text-of-1834 "The Rime of the Ancient Mariner by Samuel Taylor Coleridge") (***The Rime of the Ancient Mariner by Samuel Taylor Coleridge***)

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# url= "https://www.gutenberg.org/cache/epub/151/pg151.txt"
poem_text6<-c(" It is an ancient Mariner,",
                "And he stoppeth one of three.",
                "By thy long grey beard and glittering eye,",
                "Now wherefore stopp'st thou me?",
                "The Bridegroom's doors are opened wide,",
                "And I am next of kin;",
                "The guests are met, the feast is set:",
                "May'st hear the merry din.",
                "He holds him with his skinny hand,",
                "There was a ship,quoth he.",
                "Hold off! unhand me, grey-beard loon!",
                "Eftsoons his hand dropt he.",
                "He holds him with his glittering eye--",
                "The Wedding-Guest stood still,",
                "And listens like a three years child:",
                "The Mariner hath his will.",
                "The Wedding-Guest sat on a stone:",
                "He cannot chuse but hear;",
                "And thus spake on that ancient man,",
                "The bright-eyed Mariner.",
                "The ship was cheered, the harbour cleared,",
                "Merrily did we drop",
                "Below the kirk, below the hill,",
                "Below the light-house top.",
                "The Sun came up upon the left,",
                "Out of the sea came he!",
                "And he shone bright, and on the right",
                "Went down into the sea.",
                "Higher and higher every day,",
                "Till over the mast at noon--",
                "The Wedding-Guest here beat his breast,",
                "For he heard the loud bassoon.",
                "The bride hath paced into the hall,",
                "Red as a rose is she;",
                "Nodding their heads before her goes",
                "The merry minstrelsy.",
                "The Wedding-Guest he beat his breast,",
                "Yet he cannot chuse but hear;",
                "And thus spake on that ancient man,",
                "The bright-eyed Mariner.",
                "And now the STORM-BLAST came, and he",
                "Was tyrannous and strong:",
                "He struck with his o'ertaking wings,",
                "And chased south along.",
                "With sloping masts and dipping prow,",
                "As who pursued with yell and blow",
                "Still treads the shadow of his foe",
                "And forward bends his head,",
                "The ship drove fast, loud roared the blast,",
                "And southward aye we fled.",
                "And now there came both mist and snow,",
                "And it grew wondrous cold:",
                "And ice, mast-high, came floating by,",
                "As green as emerald.",
                "And through the drifts the snowy clifts",
                "Did send a dismal sheen:",
                "Nor shapes of men nor beasts we ken--",
                "The ice was all between.",
                "The ice was here, the ice was there,",
                "The ice was all around:",
                "It cracked and growled, and roared and howled,",
                "Like noises in a swound!",
                "At length did cross an Albatross:",
                "Thorough the fog it came;",
                "As if it had been a Christian soul,",
                "We hailed it in God's name.",
                "It ate the food it ne'er had eat,",
                "And round and round it flew.",
                "The ice did split with a thunder-fit;",
                "The helmsman steered us through!",
                "And a good south wind sprung up behind;",
                "The Albatross did follow,",
                "And every day, for food or play,",
                "Came to the mariners' hollo!",
                "In mist or cloud, on mast or shroud,",
                "It perched for vespers nine;",
                "Whiles all the night, through fog-smoke white,",
                "Glimmered the white Moon-shine.",
                "God save thee, ancient Mariner!",
                "From the fiends, that plague thee thus!--",
                "Why look'st thou so?--With my cross-bow",
                "I shot the ALBATROSS.")

```

The first few lines of the data are presented:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text6)
```

The full poem text is available [here](https://www.poetryfoundation.org/poems/45134/ode-to-the-west-wind "Ode to the West Wind by Percy Bysshe Shelley") (***Ode to the West Wind by Percy Bysshe Shelley***)

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}

poem_text7 <- c(
  "O wild West Wind, thou breath of Autumn's being,",
  "Thou, from whose unseen presence the leaves dead",
  "Are driven, like ghosts from an enchanter fleeing,",
  "Yellow, and black, and pale, and hectic red,",
  "Pestilence-stricken multitudes: O thou,",
  "Who chariotest to their dark wintry bed",
  "The winged seeds, where they lie cold and low,",
  "Each like a corpse within its grave, until",
  "Thine azure sister of the Spring shall blow",
  "Her clarion o'er the dreaming earth, and fill",
  "Driving sweet buds like flocks to feed in air",
  "With living hues and odors plain and hill:",
  "Wild Spirit, which art moving everywhere;",
  "Destroyer and Preserver; hear, oh hear!",
  
  "Thou on whose stream, 'mid the steep sky's commotion,",
  "Loose clouds like Earth's decaying leaves are shed,",
  "Shook from the tangled boughs of Heaven and Ocean,",
  "Angels of rain and lightning: there are spread",
  "On the blue surface of thine aëry surge,",
  "Like the bright hair uplifted from the head",
  "Of some fierce Maenad, even from the dim verge",
  "Of the horizon to the zenith's height,",
  "The locks of the approaching storm. Thou dirge",
  "Of the dying year, to which this closing night",
  "Will be the dome of a vast sepulchre,",
  "Vaulted with all thy congregated might",
  "Of vapors, from whose solid atmosphere",
  "Black rain, and fire, and hail will burst: oh hear!",
  
  "Thou who didst waken from his summer dreams",
  "The blue Mediterranean, where he lay,",
  "Lull'd by the coil of his crystalline streams,",
  "Beside a pumice isle in Baiae's bay,",
  "And saw in sleep old palaces and towers",
  "Quivering within the wave's intenser day,",
  "All overgrown with azure moss and flowers",
  "So sweet, the sense faints picturing them! Thou",
  "For whose path the Atlantic's level powers",
  "Cleave themselves into chasms, while far below",
  "The sea-blooms and the oozy woods which wear",
  "The sapless foliage of the ocean, know",
  "Thy voice, and suddenly grow gray with fear,",
  "And tremble and despoil themselves: oh hear!",
  
  "If I were a dead leaf thou mightest bear;",
  "If I were a swift cloud to fly with thee;",
  "A wave to pant beneath thy power, and share",
  "The impulse of thy strength, only less free",
  "Than thou, O uncontrollable! If even",
  "I were as in my boyhood, and could be",
  "The comrade of thy wanderings over Heaven,",
  "As then, when to outstrip thy skiey speed",
  "Scarce seem'd a vision; I would ne'er have striven",
  "As thus with thee in prayer in my sore need.",
  "Oh, lift me as a wave, a leaf, a cloud!",
  "I fall upon the thorns of life! I bleed!",
  "A heavy weight of hours has chain'd and bow'd",
  "One too like thee: tameless, and swift, and proud.",
  
  "Make me thy Lyre, even as the forest is:",
  "What if my leaves are falling like its own!",
  "The tumult of thy mighty harmonies",
  "Will take from both a deep, autumnal tone,",
  "Sweet though in sadness. Be thou, Spirit fierce,",
  "My spirit! Be thou me, impetuous one!",
  "Drive my dead thoughts over the universe",
  "Like wither'd leaves to quicken a new birth!",
  "And, by the incantation of this verse,",
  "Scatter, as from an unextinguish'd hearth",
  "Ashes and sparks, my words among mankind!",
  "Be through my lips to unawaken'd earth",
  "The trumpet of a prophecy! O Wind,",
  "If Winter comes, can Spring be far behind?"
)

```

The first few lines of the data are presented:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
head(poem_text7)
```

We will add a column with the name of the poem

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# we will add a column with the name of the poem
text_poem1 <- data.frame(line = 1:length(poem_text1), versuri = poem_text1) %>%
  mutate(title = 'Still_I_Rise')
head(text_poem1)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem2 <- data.frame(line = 1:length(poem_text2), versuri = poem_text2) %>%
  mutate(title = 'Kubla_Khan')
head(text_poem2)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem3 <- data.frame(line = 1:length(poem_text3), versuri = poem_text3) %>%
  mutate(title = 'Song_of_Myself')
head(text_poem3)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem4 <- data.frame(line = 1:length(poem_text4), versuri = poem_text4) %>%
  mutate(title = 'Because_I_could_not_stop_for_Death')
head(text_poem4)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem5 <- data.frame(line = 1:length(poem_text5), versuri = poem_text5) %>%
  mutate(title = 'Ode_to_a_Nightingale')
head(text_poem5)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem6 <- data.frame(line = 1:length(poem_text6), versuri = poem_text6) %>%
  mutate(title = 'Rime_of_the_Ancient_Mariner')
head(text_poem6)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
text_poem7 <- data.frame(line = 1:length(poem_text7), versuri = poem_text7) %>%
  dplyr::mutate(title = 'Ode_to_the_West_Wind')
head(text_poem7)
```

### [Dataset description]{style="color:blue;"}

The next step is to combine all created tables into one dataframe using the rbind() function.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# We will put all the poems in a single table 
poezii <- rbind(text_poem1, text_poem2, text_poem3, text_poem4, text_poem5, text_poem6, text_poem7)
head(poezii)
```

The resulting dataset (poezii) consists of seven English poems, in which each line provides information about:

1.  the number of the line verse within the poem,

2.  the text of the verse

3.  the title of the poem to which the verse belongs

The seven poem titles from our created dataset are:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# the seven poem titles from our created dataset
poezii %>%
  distinct(title)
```

We will transform our poem dataset into a structured format that is easier to analyze and parse at the level of individual words. The ***unnest_tokens()*** function from the ***tidytext*** package breaks the verses into individual words.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# we will transform our poem dataset into a structure that is easier to analysis/parse at the individual words level
# the unnest_tokens() function form the tidytext package, breaks the verses text into individual words
tidy_poezii <- poezii %>% 
  unnest_tokens(word, versuri) 

head(tidy_poezii) 
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
num_variables <- poezii %>% 
  unnest_tokens(word, versuri) %>%
  as.data.frame() %>%
  dplyr::select(-line) %>%
  group_by(title) %>%
  count(word, sort = TRUE) 
num_variables
```

All histograms show right-skewed distributions, consistent with Zipf's law. This means that a small number of frequent words (such as stopwords or common words) dominate, while many words appear only rarely. These less frequent words are often part of the author's unique vocabulary and include thematic words related to nature, emotions, symbolic imagery, and similar concepts. It is important to note that stopwords were not removed from the analyzed dataset.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
num_variables %>% 
  mutate(word = reorder(word, n)) %>%
ggplot(aes(x = n, fill = title)) +
  geom_histogram(binwidth = 0.5, color = "black") +
  facet_wrap(~title, scales = "free") +
  guides(fill = FALSE) +
  theme_minimal() +
  # geom_text(aes(label = word), hjust = -0.1, size = 3.5, fontface = 'bold', color = "pink") +  #italic", "bold.italic", "plain
  labs(
    x = "Analyzed poems",
    y = "Word Frequency",
    title = "Histogram for each analyzed poems",
    subtitle = "Word distribution for each analyzed poem"
  ) 
```

As we can see, the most frequently used word is [***the***]{style="color:purple;"}, followed by [***and***]{style="color:purple;"}, [***of***]{style="color:purple;"}, and so on.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
num_variables %>% 
  mutate(word = fct_reorder(word, n, .desc = TRUE)) %>% 
   filter(n > 6) %>%
 ggplot(aes(factor(word), n, fill = word)) +              
  geom_col(colour = "red", fill = "pink") +  
  guides(fill = FALSE) +
  # geom_text(aes(label = word), hjust = -0.1, size = 3.5, fontface = 'bold', color = "pink") +  #italic", "bold.italic", "plain
  coord_flip() +
  theme_dark() +
  theme(legend.position = "none", 
        plot.title = element_text(size = 10, face = "bold"),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.text.y = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.5))) + 
    facet_wrap(~ title, scales = "free") +
  labs(
    title = "Words distribution and the corresponding poem",
    y = "Frequancy",
    x = "Words")
```

In the next step, the stopwords will be removed from the analyzed dataset, retaining only the relevant words.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# We will remove the stop word (or linking words), like: of, and, is etc.
data(stop_words) 
tidy_poezii <- poezii %>% 
  rename(nr_linii_poezie = line) %>%
  mutate(line = row_number()) %>%
  group_by(nr_linii_poezie, title, line) %>%
  unnest_tokens(word, versuri) %>%
  anti_join(stop_words) 
head(tidy_poezii)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# the most used words are thou (11 times), rise (10 times), thy, ice etc.
tidy_poezii %>%
  as.data.frame() %>%
  dplyr::select(-line) %>%
  group_by(title) %>%
  count(word, sort = TRUE) %>%
  head()
```

It can be observed that all histograms display right-skewed distributions, consistent with Zipf's law. This means that high-frequency words, also known as common words, dominate and appear at the beginning of the distribution, while low-frequency words occur rarely and appear at the ending of the distribution.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
tidy_poezii %>%
  as.data.frame() %>%
  dplyr::select(-nr_linii_poezie, -line) %>%
  group_by(title) %>%
  count(word, sort = TRUE) %>%
ggplot(aes(x = n, fill = title)) +
  geom_histogram(binwidth = 0.5, color = "black") +
  facet_wrap(~title, scales = "free") +
  guides(fill = FALSE) +
  theme_minimal() +
  labs(
    x = "Analyzed poems",
    y = "Word Frequency",
    title = "Histogram for each analyzed poems",
    subtitle = "Word distribution for each analyzed poem")
```

## [Distribution of the words]{style="color:blue;"}

Graphic representation of the words distribution with occurrence frequency greater than 4.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Graphic representation of the most used words  
tidy_poezii %>% 
  as.data.frame() %>%
  count(word, sort = TRUE) %>% 
  filter(n > 4) %>% 
  mutate(word = reorder(word, n)) %>% 
  ggplot(aes(word, n)) + 
  geom_col(colour = "red", fill = "pink") +
  # xlab(NULL) + 
  coord_flip() +
  theme_dark() +
  theme(legend.position = "none", 
        plot.title = element_text(size = 10, face = "bold"),
        axis.text.x = element_text(size = 12, face = "bold"),
        axis.text.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold"),
        axis.title.y = element_text(size = 14, face = "bold"))+
  labs(
    title = "Words distribution with frequency of occurrence greater than 4", 
    y = "Frequancy",
    x = "Words")
```

## [Distribution of the words in each poem]{style="color:blue;"}

The poem with the largest number of words is [***Ode to a Nightingale***]{style="color:blue;"} (with 297 words), followed by [***Ode to the West Wind***]{style="color:blue;"} (with 278 words), [***Rime of the Ancient Mariner***]{style="color:blue;"} (with 226 words) and so on, as we can see from the table below. At the opposite pole is poetry [***Because I could not stop for Death***]{style="color:blue;"} with 53 words.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# The poem with the most used words
tidy_poezii %>%
  as.data.frame() %>%
  dplyr::select(-nr_linii_poezie, -line) %>%
  group_by(title) %>%
  count(title, sort = TRUE)
```

[***Ode to a Nightingale***]{style="color:blue;"} and [***Kubla Khan***]{style="color:blue;"} poems contain the largest number of words, respectively 297 words and 185 words

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Words number from each poetry
tidy_poezii %>% 
  as.data.frame() %>%
  count(title, sort = TRUE) %>% 
  filter(n >= 1) %>% 
  mutate(title = reorder(title, n)) %>% 
  ggplot(aes(title, n)) + 
  geom_col(colour = "darkgreen", fill = "green") +
  geom_text(aes(label = title), hjust = -0.21, size = 5, fontface = "bold",  color = "green") +         
  ylab(NULL) +  
  coord_flip() +
  theme_dark() +
  theme(panel.grid = element_blank(),
        axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12, face = "bold"), 
        axis.text.y = element_blank(),  # Aici se elimină coordonatele axei Y
        axis.title.x = element_text(size = 14, face = "bold"),                        
        axis.title.y = element_text(size = 14, face = "bold"),                       
        plot.title = element_text(size = 16, face = "bold"),                         
        panel.border = element_rect(fill = NA, color = "black", size = 1),         
        axis.line = element_line(color = "black"),
        legend.position = "none") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.6))) + 
  geom_label(aes(label = paste0(n, "")), size = 5, fontface = 'bold', vjust = .5, show.legend = F,   
             fill = "green",    
             colour = "darkgreen") +  
  labs(title = "Number of words in each poetry",
    y = "Frequancy",
    x = "Words")
```

In Figure below we will present the words distribution with an occurrence frequency greater than 2 in six different poems: [***Because I could not stop for Death***]{style="color:blue;"}, [***Kubla Khan***]{style="color:blue;"}, [***Ode to a Nightingale***]{style="color:blue;"}, [***Still I Rise***]{style="color:blue;"}, etc.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Words distribution as a function of frequency of occurrence in each poem 
tidy_poezii %>% 
  as.data.frame() %>%
  count(title, word, sort = TRUE) %>%   
  filter(n > 2) %>%                      
  mutate(word = reorder(word, n)) %>%    
  group_by(title)%>%
  arrange(desc(n)) %>%
  ggplot(aes(word, n, fill = title)) +   
  geom_col(colour = "red", fill = "pink") +
  coord_flip() +
  theme_dark() +
  theme(legend.position = "none", 
        plot.title = element_text(size = 10, face = "bold"),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.text.y = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold")) +
  facet_wrap(~ title, scales = "free") +  
  labs(
    title = "Words distribution in each poem",
    y = "Frequancy",
    x = "Words")
```

Each graphic presents the most used words (keywords) in each poem and their occurrence frequency.

-   In [***Because I could not stop for Death***]{style="color:blue;"} poem, words like [***passed***]{style="color:purple;"} appears 4 times;

-   In [***Kubla Khan***]{style="color:blue;"} poem words like [***dome***]{style="color:purple;"} and [***sunny***]{style="color:purple;"} appear 5 times, while words like [***sacred***]{style="color:purple;"}, [***river***]{style="color:purple;"}, [***pleasure***]{style="color:purple;"}, [***heard***]{style="color:purple;"} and [***caves***]{style="color:purple;"} appear 3 times

-   In the poem [***Ode to a Nightingale***]{style="color:blue;"}, the most frequent words are: [***thou***]{style="color:purple;"} and thee that appear 5 times each time, while [***thy***]{style="color:purple;"} appear 4 times.

-   In the poem [***Still I Rise***]{style="color:blue;"}, the word [***rise***]{style="color:purple;"} appears 10 times being, in this case, the theme of the poem.

## [Words distribution and the corresponding poem]{style="color:blue;"}

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Words distribution function of occurrence frequency and poem
tidy_poezii %>% 
  as.data.frame() %>%
  count(title, word, sort = TRUE) %>%   
  filter(n > 2) %>%                     
  mutate(word = reorder(word, n)) %>%   
  group_by(word)%>%
  filter(n == max(n)) %>%
  arrange(desc(n)) %>%
  as.data.frame() %>%
  ggplot(aes(word, n)) +              
  geom_col(colour = "red", fill = "pink") + 
  geom_text(aes(label = title), hjust = -0.1, size = 3.5, fontface = 'bold', color = "red") +  #italic", "bold.italic", "plain
  coord_flip() +  
  theme(legend.position = "none", 
        plot.title = element_text(size = 10, face = "bold"),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.text.y = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.5))) + 
  labs(
    title = "Words distribution and the corresponding poem",
    y = "Frequancy",
    x = "Words")
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}

t <- tidy_poezii %>% 
  as.data.frame() %>%
  count(title, word, sort = TRUE) %>%    
  filter(n > 2) %>%                      
  mutate(word = reorder(word, n)) %>%    
  group_by(word)%>%
  filter(n == max(n)) %>%
  arrange(desc(n)) %>%
  as.data.frame() %>%
  head(15)
t
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
tidy_poezii %>% 
  as.data.frame() %>%
  count(title, word, sort = TRUE) %>%   
  filter(n > 2) %>%                   
  mutate(word = reorder(word, n)) %>%    
  ggplot(aes(word, n, fill = title)) +  
  geom_col(position = position_dodge(width = 0.9), colour = "red") + 
  geom_text(aes(label = title),       
            position = position_dodge(width = 0.9), 
            hjust = -0.1, size = 3.5,  
            angle = 0, color = "pink") + 
  coord_flip() +
  theme_dark() +
  theme(legend.position = "none", 
        plot.title = element_text(size = 13, face = "bold"),
        axis.text.x = element_text(size = 10, face = "bold", color = "black"),
        axis.text.y = element_text(size = 10, face = "bold", color = "black"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.5))) + 
  labs(
    title = "Words distribution and the corresponding poem",
    y = "Frequancy",
    x = "Words")
```



```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
library(wordcloud)
# we arrange words function of occurrence frequency
wordcloud <- tidy_poezii %>%
  group_by(word) %>%
  summarize(freq = n()) %>%
  arrange(desc(freq)) %>%
  as.data.frame() 
wordcloud
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# top 25 most used/frequent words 
wordcloud %>%
  arrange(desc(freq)) %>%
  head(25) %>%
  ggplot(aes(x = reorder(word, desc(freq)), y = freq)) +
  geom_segment(aes(xend = word, y = 0, yend = freq), color = "purple", size = 1.5) +
  geom_point(color = "pink", size = 5, alpha = 0.6) +
  theme_dark() +
  theme( axis.text.x = element_text(size = 10, face = "bold", color = "black"),
        axis.text.y = element_text(size = 10, face = "bold", color = "black"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        text = element_text(size = 11),
        plot.title = element_text(size = 16, color = "#ff5a5f", face = "bold"),
        plot.subtitle = element_text(size = 10, color = "darkslategrey")) +
  xlab("Words") +
  ylab("Frequency") +
  ggtitle("Top 25 Most Frequent Words", subtitle = "A word frequency plot") + 
  scale_x_discrete(guide = guide_axis(n.dodge=3)) 
```

## [Graphic representation of wordcloud]{style="color:blue;"}
In order to create a word cloud, we will first calculate the term document matrix (TDM - Term-Document-Matrix), in which each title represents a document. For this reason, we will use ***tm*** or ***tidytext*** packages from R.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
tdm <- tidy_poezii %>%
  ungroup() %>%
  dplyr::select(-nr_linii_poezie, -line) %>%
  count(word, title) %>%               
  cast_dtm(term = word, document = title, value = n) %>% 
  as.matrix()
tdm <- as.matrix(tdm)
tdm[1:7, 1:100]
```

It can be seen that the most or frequent word is [***thou***]{style="color:blue;"}, [***thy***]{style="color:blue;"}, [***hear***]{style="color:blue;"} etc.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
 library(wordcloud)
w <- sort(colSums(tdm), decreasing = TRUE)
set.seed(123)
wordcloud(words = names(w),
          freq = w,
          max.words = 150,
          random.order = F,
          min.freq = 5,
          colors = brewer.pal(8, 'Dark2'),
          scale = c(5, 0.3),
          rot.per = 0.7)
```

It can also be seen that the poem with the most significant number of words is [***Ode to a Nightingale***]{style="color:blue;"}, [***Ode to the West Wind***]{style="color:blue;"}, [***Rime of the Ancient Mariner***]{style="color:blue;"} etc.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
w <- sort(rowSums(tdm), decreasing = F)
set.seed(123)
wordcloud(words = names(w),
          freq = w,
          max.words = 7,
          random.order = F,
          min.freq = 5,
          colors = brewer.pal(8, 'Dark2'),
          scale = c(5, 0.3),
          rot.per = 0.7)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# we want to find what words are the most frequent words in both Ode_to_a_Nightingale and Still_I_Rise poems (top 10 words)
# frequency by word across poems
frequency <- tidy_poezii %>%
  mutate(word = str_extract(word, "[a-z']+")) %>% 
  count(title, word) %>% 
  group_by(title) %>% 
  mutate(proportion = n / sum(n) * 100) %>%   
  ungroup() %>% 
  arrange(desc(proportion)) %>%              
  group_by(title, word) %>% 
  slice_max(order_by = n, n = 10) %>%        
  ungroup() %>% 
  select(-n, -line) %>%
  pivot_wider(names_from = title, values_from = proportion, values_fill = list(proportion = 0)) %>%  
  select(-nr_linii_poezie ) %>% 
  gather(title, proportion, Because_I_could_not_stop_for_Death:Still_I_Rise)
frequency
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
t <- tidy_poezii %>%
mutate(word = str_extract(word, "[a-z']+")) %>%  
    count(title, word) %>%  
    group_by(title) %>%
    mutate(proportion = n / sum(n) * 100) %>%  
    arrange(desc(n), desc(proportion)) %>%  
    slice_max(order_by = proportion, n = 10, with_ties = FALSE) %>%  
    pivot_wider(names_from = title, values_from = proportion, values_fill = list(proportion = 0)) 
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# What are the common words that appear in more than one poem
common_words <- tidy_poezii %>%
  mutate(word = str_extract(word, "[a-z']+")) %>% 
  count(title, word) %>% 
  group_by(title) %>% 
  mutate(proportion = n / sum(n) * 100) %>%  
  ungroup() %>% 
  arrange(desc(proportion)) %>%              
  group_by(title, word) %>% 
  slice_max(order_by = n, n = 10) %>%       
  ungroup() %>%
  count(word, title) %>%  
  group_by(word) %>%
  filter(n() > 1) 
common_words
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# bar plot distribution to present common words across different poems
ggplot(common_words %>% head(10), aes(x = word, fill = title, y = n)) + 
  geom_bar(stat = "identity", position = "dodge") +  
  coord_flip() +
  theme_dark() +
  scale_y_discrete(expand = expansion(mult = c(0, 0.9))) +   
  geom_text(aes(label = title),         
            position = position_dodge(width = 0.9), 
            hjust = -0.1,             
            size = 4,                 
            fontface = "bold",          
            color = "green") +           
    theme(legend.position = "none",
      axis.text.x = element_text(hjust = 0.5, size = 12, face = "bold"),  
      axis.text.y = element_text(size = 12, face = "bold"),   
      axis.title.x = element_text(size = 14, face = "bold"),                         
      axis.title.y = element_text(size = 14, face = "bold"),                        
      plot.title = element_text(size = 16, face = "bold")) +
  labs(
    title = "Distribution of common words across poems",
    y = "Frequancy",
    x = "Common Words") + 
  geom_label(aes(label = paste0(n, "")), size = 5, fontface = 'bold', vjust = .5, show.legend = F,   
           fill = "green",    
           colour = "darkgreen") 
  
```


## [Comparative analysis of common words frequency in the Still I rise poem written by Bysshe Shelley and the other poems]{style="color:blue;"}

In the next step, we will graphically represent the common words across analyzed poems and compare them with the poem write by [***Bysshe Shelley***]{style="color:blue;"}. To do that, first we must find the common words from ***Ode to the West Wind*** poem written by [***Bysshe Shelley***]{style="color:blue;"} and the other poems:

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, results="markup"}
# we will find the common words across multiple poems and compare them with the poem write by Bysshe_Shelley
# Find common words across multiple poems
common_words <- bind_rows(mutate(text_poem1 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Maya_Angelou"),
                          mutate(text_poem2 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Samuel_Taylor_Coleridge"), 
                          mutate(text_poem3 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Walt_Whitman"), 
                          mutate(text_poem4 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Emily_Dickinson"), 
                          mutate(text_poem5 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "John_Keats"), 
                          mutate(text_poem6 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Samuel_Taylor_Coleridge"), 
                          mutate(text_poem7 %>%unnest_tokens(word, versuri) %>%anti_join(stop_words), author = "Bysshe_Shelley")) %>% 
  mutate(word = str_extract(word, "[a-z']+")) %>% 
  count(author, word) %>% 
  group_by(author) %>% 
  mutate(proportion = n / sum(n)) %>%
  select(-n) %>% 
  spread(author, proportion) %>% 
  gather(author, proportion, Emily_Dickinson:Walt_Whitman)%>%
  filter(proportion > 0.001, Bysshe_Shelley>0.001) 
common_words
```

We will use the text peome witten by [***Bysshe Shelley***]{style="color:blue;"} as a reference to which the other poetry are compared. Word that are close to the line have similar frequencies in both poems. As can be seen from the table above, the common words that [***Bysshe Shelley***]{style="color:blue;"} uses in [***Ode to the West Wind***]{style="color:blue;"} poetry also appear in [***Emily Dickinson***]{style="color:blue;"}, [***John_Keats***]{style="color:blue;"} etc. poems, but the proportion is different. The first 2 common words are [***day***]{style="color:purple;"} and [***quivering***]{style="color:purple;"} and appear in both [***Bysshe Shelley***]{style="color:blue;"} and [***Emily Dickinson***]{style="color:blue;"} poetry and have the greatest proportion (1.8896%). The common words used by [***Bysshe Shelley***]{style="color:blue;"} that also appears in [***John Keats***]{style="color:blue;"} poetry are [***air***]{style="color:purple;"}, [***art***]{style="color:purple;"}, [***boughs***]{style="color:purple;"} etc. whit a proportion of 0.3367%. In order to have a clear image of these common words, we will graphically represent the common words from the [***Bysshe Shelley***]{style="color:blue;"} poetry and the poems written by the other authors.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# we can represent graphic the interrogation result 
ggplot(common_words %>% filter(!is.na(proportion)), aes(x=proportion, y= Bysshe_Shelley,
                         color = abs(Bysshe_Shelley - proportion))) + 
  geom_abline(color = "green", lty = 2) +
  geom_jitter(alpha = 0.1, size = 3.5, width=0.3, height = 0.3) +
  geom_text(aes(label = word), check_overlap = TRUE, vjust = 2.5, size = 5, fontface = 'bold', show.legend = F) +
  scale_x_log10(labels = percent_format()) + 
  scale_y_log10(labels = percent_format()) + 
  scale_color_gradient(limits = c(0, 1), low = "green", high = "darkgreen") +
  facet_wrap(~author, ncol = 3) + 
  theme(legend.position="right") + 
  labs(y = "Bysshe_Shelley", x = NULL) +
  theme_dark() +
  theme(panel.grid = element_blank(),
        axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12, face = "bold"),  # Text pe axa X
        axis.text.y = element_text(angle = 0, size = 12, face = "bold"),              # Text pe axa Y
        axis.title.x = element_text(size = 10, face = "bold"),                         # Titlu axa X
        axis.title.y = element_text(size = 10, face = "bold"),                         # Titlu axa Y
        plot.title = element_text(size = 14, face = "bold", color = "darkgreen"),        # Titlu grafic
        plot.subtitle = element_text(size = 14, face = 'bold', color = 'darkgreen'),
        panel.border = element_rect(fill = NA, color = "black", size = 1),             # Bordura
        axis.line = element_line(color = "black"),
        legend.position = "none") +
  labs(
    # title = "Accurrence word distribution in analyzed poems",
    subtitle = 'A comparative analysis of the accurrence frequency of words used by 
    Bysshe Shelley and the other analyzed authors',
    y = "Words proportion from Bysshe_Shelley poem (%)",
    x = "Words proportion (%)") 
suppressMessages(library(ggplot2))
```

## [Correlation analysis]{style="color:blue;"}

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# min/max frequency of the words used by Bysshe_Shelley in Ode_to_the_West_Wind poetry
cat('The minimum relative frequency of used words by Bysshe_Shelley is: ', max(common_words$Bysshe_Shelley, na.rm = T))
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
cat('The minimum relative frequency of used words by Bysshe_Shelley is: ', min(common_words$Bysshe_Shelley, na.rm = T))
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
common_words %>%
  filter(!is.na(Bysshe_Shelley)) %>%
  arrange(desc(proportion)) %>%
  slice_max(Bysshe_Shelley, n = 30) %>%
  filter(!is.na(proportion))
```

As can be seen the authors that uses the same words (with frequency closer to that of words used by ***Bysshe Shelley*** in [***Ode to the West Wind***]{style="color:blue;"}) as [***Bysshe Shelley***]{style="color:blue;"} are: [***John Keats***]{style="color:blue;"} and [***Samuel Taylor Coleridge***]{style="color:blue;"}.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
common_words %>%
  filter(!is.na(Bysshe_Shelley)) %>%
  arrange(desc(proportion)) %>%
  slice_min(Bysshe_Shelley, n = 10)
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# min/max frequency of the common words used by Bysshe_Shelley in Ode_to_the_West_Wind poetry and that also appear in the other analyzed poems
cat('The minimum relative frequency of common words is: ', min(common_words$proportion))
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
cat('The maximum relative frequency of common words is: ', max(common_words$proportion))
```

The correlation test results sustain what we observed above. The author that uses the same words like [***Bysshe Shelley***]{style="color:blue;"} is [***John Keats***]{style="color:blue;"}. The correlation coefficient values range from -1 to 1, indicating the strength and direction of the relationship between to variables ([***Bysshe Shelley***]{style="color:blue;"} words frequency and proportion - the frequency of words used by the other analyzed authors). It can be seen that the strongest correlation is between [***Bysshe Shelley***]{style="color:blue;"} and [***John Keats***]{style="color:blue;"} (0.7921, indicating a direct or positive relationship) and is statistically significant (p-value is less than 0.05 =\> we reject the null hypothesis, with an assumed risk of 5%). [***Bysshe Shelley***]{style="color:blue;"} and [***John Keats***]{style="color:blue;"} have a similar vocabulary and tend to use similar words with similar frequency and proportion. On the other hand, the vocabulary used by [***Samuel Taylor Coleridge***]{style="color:blue;"} is different from the one used by [***Bysshe Shelley***]{style="color:blue;"}. This two authors use different words or the frequency of the used words is very different.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
test_corelatie_autori <- function(data) {
  
  # Eliminăm valorile lipsă
  data_clean <- data %>%
    drop_na(proportion, Bysshe_Shelley)  # Elimină rândurile cu NA în aceste coloane
  
  # Iterăm pentru fiecare autor și calculăm corelația
  rezultate_corelatie <- data_clean %>%
    group_by(author) %>%
    filter(var(proportion, na.rm = TRUE) > 0 & var(Bysshe_Shelley, na.rm = TRUE) > 0) %>%
    summarise(
      n_observatii = n(),  # Numărăm observațiile
      cor_value = ifelse(n_observatii > 2, cor(proportion, Bysshe_Shelley, use = "complete.obs"), NA),
      p_value = ifelse(n_observatii > 2, cor.test(proportion, Bysshe_Shelley)$p.value, NA),
      conf_low = ifelse(n_observatii > 2, cor.test(proportion, Bysshe_Shelley)$conf.int[1], NA),
      conf_high = ifelse(n_observatii > 2, cor.test(proportion, Bysshe_Shelley)$conf.int[2], NA)
    ) %>%
    ungroup()
  
  # Afișăm rezultatele într-un tabel frumos utilizând gt
  rezultate_corelatie %>%
    gt::gt() %>%
    gt::tab_header(
      title = "Correlation test results", # Rezultatele testului de corelație
      subtitle = 'Correlation between words used by Bysshe Shelley and those used by other authors' # Corelația dintre proporțiile cuvintelor lui Bysshe Shelley și ceilalți autori
    ) %>%
    gt::fmt_number(columns = c(cor_value, p_value, conf_low, conf_high), 
      decimals = 4)
}
```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}
# test_corelatie_autori(common_words)
```

## [References:]{style="color:blue;"}

1.  Qiushi Yan, Notes for Text Mining with R: A Tidy Approach, 2020, <https://bookdown.org/Maxine/tidy-text-mining/compare-word-frequency.html> accessed on 14.01.2025.

2.  <https://github.com/dgrtwo/tidy-text-mining/blob/master/01-tidy-text.Rmd> accessed on 14.01.2025.

3.  Silge, Julia and David Robinson. "Text Mining with R: A Tidy Approach.", 2017.

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}

```

```{r, echo = FALSE, warning=FALSE, error=FALSE, message=FALSE}

```
